rm(list=ls())
library(latex2exp)

#=====================================#
#Read Data
#=====================================#

data1  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES100.txt",header=TRUE)
data2  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES150.txt",header=TRUE)
data3  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES200.txt",header=TRUE)
data4  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES250.txt",header=TRUE)
data5  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES300.txt",header=TRUE)
data6  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES350.txt",header=TRUE)
data7  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES400.txt",header=TRUE)
data8  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES450.txt",header=TRUE)
data9  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES500.txt",header=TRUE)
data10 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES550.txt",header=TRUE)
data11 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES600.txt",header=TRUE)
data12 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES650.txt",header=TRUE)
data13 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES700.txt",header=TRUE)
data14 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES750.txt",header=TRUE)
data15 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES800.txt",header=TRUE)
data16 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES850.txt",header=TRUE)
data17 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES900.txt",header=TRUE)
data18 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES950.txt",header=TRUE)
data19 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1ESTIMATES1000.txt",header=TRUE)

data1  <- as.matrix(data1)
data2  <- as.matrix(data2)
data3  <- as.matrix(data3)
data4  <- as.matrix(data4)
data5  <- as.matrix(data5)
data6  <- as.matrix(data6)
data7  <- as.matrix(data7)
data8  <- as.matrix(data8)
data9  <- as.matrix(data9)
data10 <- as.matrix(data10)
data11 <- as.matrix(data11)
data12 <- as.matrix(data12)
data13 <- as.matrix(data13)
data14 <- as.matrix(data14)
data15 <- as.matrix(data15)
data16 <- as.matrix(data16)
data17 <- as.matrix(data17)
data18 <- as.matrix(data18)
data19 <- as.matrix(data19)



d1  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE100.txt",header=TRUE)
d2  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE150.txt",header=TRUE)
d3  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE200.txt",header=TRUE)
d4  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE250.txt",header=TRUE)
d5  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE300.txt",header=TRUE)
d6  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE350.txt",header=TRUE)
d7  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE400.txt",header=TRUE)
d8  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE450.txt",header=TRUE)
d9  <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE500.txt",header=TRUE)
d10 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE550.txt",header=TRUE)
d11 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE600.txt",header=TRUE)
d12 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE650.txt",header=TRUE)
d13 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE700.txt",header=TRUE)
d14 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE750.txt",header=TRUE)
d15 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE800.txt",header=TRUE)
d16 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE850.txt",header=TRUE)
d17 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE900.txt",header=TRUE)
d18 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE950.txt",header=TRUE)
d19 <- read.table("C:/Users/Isaac/Documents/RGTG/Simulation Study/1SE1000.txt",header=TRUE)

d1  <- as.matrix(d1)
d2  <- as.matrix(d2)
d3  <- as.matrix(d3)
d4  <- as.matrix(d4)
d5  <- as.matrix(d5)
d6  <- as.matrix(d6)
d7  <- as.matrix(d7)
d8  <- as.matrix(d8)
d9  <- as.matrix(d9)
d10 <- as.matrix(d10)
d11 <- as.matrix(d11)
d12 <- as.matrix(d12)
d13 <- as.matrix(d13)
d14 <- as.matrix(d14)
d15 <- as.matrix(d15)
d16 <- as.matrix(d16)
d17 <- as.matrix(d17)
d18 <- as.matrix(d18)
d19 <- as.matrix(d19)


#Calculates
theta <- c(2.071,0.013,0.034,3.881,1.220) 

LP1  <- data1-d1*qnorm(0.975)
LP2  <- data2-d2*qnorm(0.975)
LP3  <- data3-d3*qnorm(0.975)
LP4  <- data4-d4*qnorm(0.975)
LP5  <- data5-d5*qnorm(0.975)
LP6  <- data6-d6*qnorm(0.975)
LP7  <- data7-d7*qnorm(0.975)
LP8  <- data8-d8*qnorm(0.975)
LP9  <- data9-d9*qnorm(0.975)
LP10 <- data10-d10*qnorm(0.975)
LP11 <- data11-d11*qnorm(0.975)
LP12 <- data12-d12*qnorm(0.975)
LP13 <- data13-d13*qnorm(0.975)
LP14 <- data14-d14*qnorm(0.975)
LP15 <- data15-d15*qnorm(0.975)
LP16 <- data16-d16*qnorm(0.975)
LP17 <- data17-d17*qnorm(0.975)
LP18 <- data18-d18*qnorm(0.975)
LP19 <- data19-d19*qnorm(0.975)


UP1  <- data1+d1*qnorm(0.975)
UP2  <- data2+d2*qnorm(0.975)
UP3  <- data3+d3*qnorm(0.975)
UP4  <- data4+d4*qnorm(0.975)
UP5  <- data5+d5*qnorm(0.975)
UP6  <- data6+d6*qnorm(0.975)
UP7  <- data7+d7*qnorm(0.975)
UP8  <- data8+d8*qnorm(0.975)
UP9  <- data9+d9*qnorm(0.975)
UP10 <- data10+d10*qnorm(0.975)
UP11 <- data11+d11*qnorm(0.975)
UP12 <- data12+d12*qnorm(0.975)
UP13 <- data13+d13*qnorm(0.975)
UP14 <- data14+d14*qnorm(0.975)
UP15 <- data15+d15*qnorm(0.975)
UP16 <- data16+d16*qnorm(0.975)
UP17 <- data17+d17*qnorm(0.975)
UP18 <- data18+d18*qnorm(0.975)
UP19 <- data19+d19*qnorm(0.975)


m_theta <- matrix(rep(theta,3000),byrow = T, nrow = 3000)

CP1 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP1,m_theta,UP1),byrow = FALSE, nrow = 3000)
CP1 <- apply(CP1,2,mean)
CP2 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP2,m_theta,UP2),byrow = FALSE, nrow = 3000)
CP2 <- apply(CP2,2,mean)
CP3 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP3,m_theta,UP3),byrow = FALSE, nrow = 3000)
CP3 <- apply(CP3,2,mean)
CP4 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP4,m_theta,UP4),byrow = FALSE, nrow = 3000)
CP4 <- apply(CP4,2,mean)
CP5 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP5,m_theta,UP5),byrow = FALSE, nrow = 3000)
CP5 <- apply(CP5,2,mean)
CP6 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP6,m_theta,UP6),byrow = FALSE, nrow = 3000)
CP6 <- apply(CP6,2,mean)
CP7 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP7,m_theta,UP7),byrow = FALSE, nrow = 3000)
CP7 <- apply(CP7,2,mean)
CP8 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP8,m_theta,UP8),byrow = FALSE, nrow = 3000)
CP8 <- apply(CP8,2,mean)
CP9 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP9,m_theta,UP9),byrow = FALSE, nrow = 3000)
CP9 <- apply(CP9,2,mean)
CP10 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP10,m_theta,UP10),byrow = FALSE, nrow = 3000)
CP10 <- apply(CP10,2,mean)
CP11 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP11,m_theta,UP11),byrow = FALSE, nrow = 3000)
CP11 <- apply(CP11,2,mean)
CP12 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP12,m_theta,UP12),byrow = FALSE, nrow = 3000)
CP12 <- apply(CP12,2,mean)
CP13 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP13,m_theta,UP13),byrow = FALSE, nrow = 3000)
CP13 <- apply(CP13,2,mean)
CP14 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP14,m_theta,UP14),byrow = FALSE, nrow = 3000)
CP14 <- apply(CP14,2,mean)
CP15 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP15,m_theta,UP15),byrow = FALSE, nrow = 3000)
CP15 <- apply(CP15,2,mean)
CP16 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP16,m_theta,UP16),byrow = FALSE, nrow = 3000)
CP16 <- apply(CP16,2,mean)
CP17 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP17,m_theta,UP17),byrow = FALSE, nrow = 3000)
CP17 <- apply(CP17,2,mean)
CP18 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP18,m_theta,UP18),byrow = FALSE, nrow = 3000)
CP18 <- apply(CP18,2,mean)
CP19 <- matrix(mapply(function(x,y,z) ifelse((x<y)&(y<z)==TRUE,1,0),LP19,m_theta,UP19),byrow = FALSE, nrow = 3000)
CP19 <- apply(CP19,2,mean)

CP <- rbind(CP1,CP2,CP3,CP4,CP5,CP6,CP7,CP8,CP9,CP10,CP11,CP12,CP13,CP14,CP15,CP16,CP17,CP18,CP19)
n  <- seq(100,1000,50)

#===============#
#=====BETA'S====#
#===============#
par(mar = c(4,5,3,3), las = 0, mgp = c(3.5,0.5,0))
plot(n,  CP[,1], type = "l", pch = 20, xlab = "", ylab = "", lty = 1, lwd = 3, xlim = c(100,1000), ylim=c(0.92,0.96), font.axis = 1.8, cex.axis = 1.6, cex.lab = 2, font.lab = 1.8, main = "",col = "blue")
lines(n, CP[,2], type = "l", lty = 1, lwd = 3, xlab = "", ylab = "",col = "red")
lines(n, CP[,3], type = "l", lty = 1, lwd = 3, xlab = "", ylab = "",col = "green")
legend(x = c(700,900), y = c(0.92,0.94), box.lty = 0, horiz = FALSE, cex = 1.8, lty=c(1,1,1), lwd = 2, col=c("blue","red","green"),
       legend = c(text=TeX("$\\hat{\\beta}_{1p}$"),text=TeX("$\\hat{\\beta}_{2p}$"),text=TeX("$\\hat{\\beta}_{3p}$")))
mtext(text = "n",side = 1,line = 2, cex = 2)
mtext(text = "CP",side = 2,line = 2, cex = 2)
abline(h = 0.95,col="black",lty='dashed')

#======================#
#=====NU AND LAMBDA====#
#======================#
par(mar = c(4,5,3,3), las = 0, mgp = c(3.5,0.5,0))
plot(n,  CP[,4], type = "l", pch = 20, xlab = "", ylab = "", lty = 1, lwd = 3, xlim = c(100,1000), ylim=c(0.92,0.96), font.axis = 1.8, cex.axis = 1.6, cex.lab = 2, font.lab = 1.8, main = "",col = "blue")
lines(n, CP[,5], type = "l", lty = 1, lwd = 3, xlab = "", ylab = "",col = "red")

legend(x = c(700,900), y = c(0.92,0.94), box.lty = 0, horiz = FALSE, cex = 1.8, lty=c(1,1), lwd = 2, col=c("blue","red"),
       legend = c(text=TeX("$\\hat{\\lambda}_{p}$"),text=TeX("$\\hat{\\nu}_{p}$")))
mtext(text = "n",side = 1,line = 2, cex = 2)
mtext(text = "CP",side = 2,line = 2, cex = 2)
abline(h = 0.95,col="black",lty='dashed')






